---
title: "Yeast Report"
author: "Zebulun Arendsee"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Yeast Report}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, echo=FALSE, message=FALSE}
# uncomment to run the analysis
# document()
library(fagin)
library(rmonad)
library(ggplot2)
library(knitr)
library(dplyr)
library(magrittr)
require(CNEr)
require(GenomicRanges)
con <- config()
file.symlink("../inst/yeast", "INPUT")
# file.symlink("/db/fagin-input/brassicaceae", "INPUT")
# con@input@focal_species = "Arabidopsis_thaliana"
# con@synder@offsets = c(0L,1L) # offsets for Satsuma
con@synder@offsets = c(1L,1L) # offsets for Satsuma
d <- run_fagin(con)
missues(d) %>% kable(format='html') %>% write('ARCHIVE/issues.html')
mtabulate(d, code=TRUE) %>% kable(format='html') %>% write('ARCHIVE/table.html')
es <- rmonad::get_error(ms)
ws <- rmonad::get_warnings(ms)
makeExcelSpreadsheet(con, filename="ARCHIVE/results.xlsx")
```

## Input data summary

```{r, echo=FALSE}
load('ARCHIVE/d1.Rda')
ss <- invertSummaries(d1)
```

```{r, fig.width=6, fig.height=4, echo=FALSE, message=FALSE}
plot(d1@tree)
```

```{r, echo=FALSE, result='asis'}
speciesOrder <- getSpeciesPhylogeneticOrder(con)
knitr::kable(
  makeGenomeTable(ss, speciesOrder),
  caption="**Genomic statistics**. *scafs* - number of scaffolds in the genome. *bases* - total number of bases in the genome. *prots* - total number of protein coding models. *GC* - the percent of G and C nucleotides in the genome. *oddstart* - number of coding sequences that do not begin with M. *oddstop* - number of coding sequences that do not end with a stop (\\*). *p_N* - number of unknown nucleotides (N) in the genome. *n_stop* - number of coding sequences with an internal stop."
)
```

```{r, echo=FALSE, result='asis'}
knitr::kable(
    makeSynmapTable(con, speciesOrder),
    caption="Lengths of homologous links in each synteny map."
)
```

## `synder` output

```{r, echo=FALSE, results='asis', message=FALSE}
knitr::kable(
    makeSynderTable(con, speciesOrder),
    caption="Search interval widths"
)
```

## Fagin output

```{r, fig.width=8, fig.height=6, echo=FALSE}
plotSecondaryLabels(con, speciesOrder)
```

```{r, fig.width=8, fig.height=4, echo=FALSE}
plotSecondaryLabels(con, speciesOrder, fill='species')
```

## Origin classifications

**TODO - fill this out**

## System info

**TODO - dump the collected session info here**
